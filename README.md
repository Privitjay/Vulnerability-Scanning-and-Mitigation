# Vulnerability-Scanning-and-Mitigation
This is a vulnerability scanning and mitigation project aims at identifying weaknesses or vulnerabilities in a system with Metasploitable 2 as a case study using scanning tools and techniques to identify and implement possible mitigations to identified vulnerabilities.

### **Setup**

- Virtualbox
- Metasploitable (server machine)
- Kali Linux 
 

**Tools Used:**

- Metasploit
- Hydra
- Nmap
- Nikto
- Dirb
- Enum4linux

**### Phase 1**

**- Scanning Server Machine**

**Nmap Scan Result**
here i used the vulnerability scanning tool to scan the  server for vulnerabilities.

for the Metasploitable i discovered a couple of ports open

1/tcp   open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.1.102
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable

22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 600fcfe1c05f6a74d69024fac4d56ccd (DSA)
|_  2048 5656240f211ddea72bae61b1243de8f3 (RSA)

23/tcp   open  telnet      Linux telnetd

25/tcp   open  smtp        Postfix smtpd
|_ssl-date: 2024-05-01T19:14:44+00:00; +2s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|_    SSL2_DES_192_EDE3_CBC_WITH_MD5
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45

53/tcp   open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2

80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux

111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      50819/udp   mountd
|   100005  1,2,3      54842/tcp   mountd
|   100021  1,3,4      36370/udp   nlockmgr
|   100021  1,3,4      44496/tcp   nlockmgr
|   100024  1          33932/tcp   status
|_  100024  1          45908/udp   status

139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 57
|   Capabilities flags: 43564
|   Some Capabilities: SupportsTransactions, LongColumnFlag, Support41Auth, SupportsCompression, SwitchToSSLAfterHandshake, Speaks41ProtocolNew, ConnectWithDatabase
|   Status: Autocommit
|_  Salt: eeK'}cZwj-=/oe,Gd@S`

5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
|_ssl-date: 2024-05-01T19:14:44+00:00; +2s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45

5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)

6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 4:10:34
|   source ident: nmap
|   source host: DD575FAB.78DED367.FFFA6D49.IP
|_  error: Closing Link: yfjnkqvxi[192.168.1.102] (Quit: yfjnkqvxi)

8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request

 8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/5.5
|_http-favicon: Apache Tomcat

MAC Address: 08:00:27:84:25:5B (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_smb2-time: Protocol negotiation failed (SMB2)
|_clock-skew: mean: 1h00m02s, deviation: 2h00m00s, median: 1s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2024-05-01T15:14:36-04:00
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: 000000000000 (Xerox)
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)


**### Exploitation/Mtigation**


**- FTP port 21:**

Upon examination, I found that this port permitted anonymous logins. However, this wasn't sufficient to gain entry to the system. I subsequently employed Hydra with wordlist and passlist to attempt a brute force on the FTP, successfully uncovering a username and password, thereby securing access. Furthermore, I identified an exploit for the FTP version, specifically vsftpd 2.3.4, using Metasploit.

   **-Mitigation**

It is recommended to temporarily close this port if it is not currently in use and promptly update the FTP application to its most recent version. Additionally, it is advised to strengthen the FTP username and password by increasing their length and incorporating more complex characters.


**Port 22 SSH:**
The system was breached using a Metasploit exploit, in conjunction with a username list and a password list.

  **-Mtigation**
 
  1. Password and Username for ssh logins should be more complex 
 
 2. SSh ports should be closed if not in use 
 

**139 & 445 SAMBA:**

 On port 139 & 445 we can see Samba in these two ports listening and we can exploit using metasploit and use exploit/multi/samba/usermap_script module

  **-Mtigation**

1. This port should be closed.

**Port 2049 NFS_ACL:**

NFS is a Network File Sharing protocol that allows users to share directories and files over the network across different operating systems.

sudo mkdir -p /mnt/nfsacl
sudo chmod -R 777 /mnt/nfsacl
sudo mount -o nolock ip adress :/mnt/nfsacl

These  commands listed above can be used to create an unauthorised shell on the clients server..

 **Mtigation**
Ports like these should be closed on the clients server.

**Port 8081 APACHE TOMCAT**

A service was detected to be operational on port 8081. I utilized a Metasploit exploit, along with default Tomcat login credentials, resulting in the creation of a meterpreter session.

 **-Mtigation**

It is advisable to temporarily close any unused ports on the server. However, if a port is in use, ensure that the latest version of the associated web application is installed. Additionally, employ complex login credentials to enhance security.


**### Key Achievements:**

1. Identified and reported five critical vulnerabilities, including Ftp anonymous Logins and other vulnerabilities , e.g., SQL Injection, cross-site scripting], leading to significant security enhancements.
2. Enhanced security postures by recommending solutions or improvements, e.g., security patches, configuration changes, security policies.



**### Conclusion:**

During the penetration testing engagement, I identified critical vulnerabilities within the Metasploitable 2 system and its applications. Key findings included misconfigured files and outdated software versions, which provided valuable insights for enhancing security measures. Recommendations include updating applications to their most recent versions, properly configuring files, dropping any ports that are not in use  and consistently applying patches to strengthen the server's security.




.
